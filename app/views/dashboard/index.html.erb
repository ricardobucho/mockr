<div class="container-fluid app-container">
  <div class="mx-auto px-4">
    <header class="app-header d-flex align-items-center">
      <div class="header-left d-flex align-items-center gap-3" data-controller="theme">
        <a href="/">
          <%= image_tag("mockr.svg", class: "logo") %>
        </a>
        <button
          class="theme-switch theme-switch-sm"
          type="button"
          data-action="click->theme#toggle"
          aria-label="Toggle theme"
        >
          <span class="theme-switch-track">
            <i class="bi bi-sun-fill theme-switch-icon theme-switch-icon-light"></i>
            <i class="bi bi-moon-fill theme-switch-icon theme-switch-icon-dark"></i>
            <span class="theme-switch-thumb" data-theme-target="icon"></span>
          </span>
        </button>
      </div>
      
      <div class="header-center d-flex align-items-center">
        <%=
          form_tag(
            clients_path,
            method: "get",
            data: {
              turbo_frame: "clients",
              controller: "search-form",
            }
          ) do
        %>
          <div class="input-group input-group-sm search-group">
            <span class="input-group-text">
              <i class="bi bi-search"></i>
            </span>
            <input
              type="text"
              class="form-control"
              name="q"
              placeholder="Search endpoints..."
              maxlength="50"
              data-search-form-target="textInput"
              data-action="keyup->search-form#submit"
            />
            <button
              type="button"
              class="btn btn-search-clear"
              data-action="click->search-form#clear"
            >
              <i class="bi bi-x-lg"></i>
            </button>
          </div>
        <% end %>
      </div>
      
      <div class="header-right d-flex align-items-center justify-content-end gap-3">
        <span class="user-info">
          <i class="bi bi-<%= current_user_icon %> me-1"></i>
          <%= current_user.provider_username %>
        </span>
        <% if current_user.manager? %>
          <div class="dropdown manage-dropdown">
            <button 
              class="btn btn-header-manage" 
              type="button" 
              data-bs-toggle="dropdown"
              data-bs-display="static"
              aria-expanded="false"
            >
              <i class="bi bi-sliders2"></i>
              <span>Manage</span>
              <i class="bi bi-chevron-down"></i>
            </button>
            <ul class="dropdown-menu dropdown-menu-end">
              <li>
                <%= link_to manage_users_path, class: "dropdown-item", data: { turbo_frame: "drawer" } do %>
                  <i class="bi bi-people"></i>
                  <span>Users</span>
                <% end %>
              </li>
            </ul>
          </div>
        <% end %>
        <div class="header-buttons d-flex align-items-center">
          <button
            class="btn btn-header-action"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#settingsPanel"
            aria-expanded="false"
            aria-controls="settingsPanel"
            data-bs-tooltip="Settings"
            data-bs-placement="bottom"
          >
            <i class="bi bi-gear"></i>
          </button>
          <span class="header-divider"></span>
          <%= link_to(logout_path, class: "btn btn-header-action", data: { turbo: false, bs_toggle: "tooltip", bs_title: "Logout", bs_placement: "bottom" }) do %>
            <i class="bi bi-box-arrow-right"></i>
          <% end %>
        </div>
      </div>
    </header>

    <div class="collapse settings-panel" id="settingsPanel">
      <div class="settings-panel-content">
        <div class="row g-4">
          <div class="col-md-6">
            <div class="settings-section">
              <h6 class="settings-section-title">
                <i class="bi bi-info-circle me-2"></i>About
              </h6>
              <p class="text-muted small mb-0">
                Mockr is a simple tool for creating mock API endpoints and responses.
                Search and browse all available endpoints, or use the Manage panel to create new ones.
                <% if ENV.fetch("GITHUB_ORGANIZATION", nil).present? %>
                  Restricted to <code><%= ENV.fetch("GITHUB_ORGANIZATION") %></code> members.
                <% end %>
                <a href="https://github.com/ricardobucho/mockr" target="_blank" class="settings-github-link" data-bs-toggle="tooltip" data-bs-title="View on GitHub"><i class="bi bi-github"></i></a>
              </p>
            </div>
          </div>
          
          <div class="col-md-6">
            <div class="settings-section">
              <h6 class="settings-section-title">
                <i class="bi bi-key me-2"></i>API Token
              </h6>
              <p class="text-muted small mb-2">
                Use this token in the <code>Authorization</code> header.
              </p>
              <%= render "user/regenerate_token" %>
            </div>
          </div>
        </div>
      </div>
    </div>

    <main class="mt-4">
      <%= turbo_frame_tag "clients", src: clients_path %>
    </main>
  </div>
</div>
