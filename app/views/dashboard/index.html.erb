<div class="container-fluid app-container">
  <div class="mx-auto px-4 py-3">
    <header class="app-header d-flex align-items-center">
      <div class="header-left">
        <a href="/">
          <%= image_tag("mockr.svg", class: "logo") %>
        </a>
      </div>
      
      <div class="header-center">
        <%=
          form_tag(
            clients_path,
            method: "get",
            data: {
              turbo_frame: "clients",
              controller: "search-form",
            }
          ) do
        %>
          <div class="input-group input-group-sm search-group">
            <span class="input-group-text">
              <i class="bi bi-search"></i>
            </span>
            <input
              type="text"
              class="form-control"
              name="q"
              placeholder="Search endpoints..."
              maxlength="50"
              data-search-form-target="textInput"
              data-action="keyup->search-form#submit"
            />
            <button
              type="button"
              class="btn btn-search-clear"
              data-action="click->search-form#clear"
            >
              <i class="bi bi-x-lg"></i>
            </button>
          </div>
        <% end %>
      </div>
      
      <div class="header-right d-flex align-items-center justify-content-end gap-3">
        <span class="user-info">
          <i class="bi bi-<%= current_user_icon %> me-1"></i>
          <%= current_user.provider_username %>
        </span>
        <div class="header-buttons d-flex align-items-center">
          <button
            class="btn btn-header-action"
            type="button"
            data-bs-toggle="offcanvas"
            data-bs-target="#mockrOffcanvas"
            aria-controls="mockrOffcanvas"
            data-tooltip="Settings"
            data-tooltip-placement="bottom"
          >
            <i class="bi bi-gear"></i>
          </button>
          <% if current_user.manager? %>
            <a href="<%= avo_path %>" data-turbo="false" class="btn btn-header-action" data-bs-toggle="tooltip" data-bs-title="Manage" data-bs-placement="bottom">
              <i class="bi bi-sliders"></i>
            </a>
          <% end %>
          <span class="header-divider"></span>
          <%= link_to(logout_path, class: "btn btn-header-action", data: { bs_toggle: "tooltip", bs_title: "Logout", bs_placement: "bottom" }) do %>
            <i class="bi bi-box-arrow-right"></i>
          <% end %>
        </div>
      </div>
    </header>

    <main class="mt-4">
      <%= turbo_frame_tag "clients", src: clients_path %>
    </main>
  </div>
</div>

<div
  class="offcanvas offcanvas-start"
  tabindex="-1"
  id="mockrOffcanvas"
>
  <div class="offcanvas-header">
    <%= image_tag("mockr.svg", height: 28) %>
    <button
      type="button"
      class="btn-close"
      data-bs-dismiss="offcanvas"
      aria-label="Close"
    ></button>
  </div>
  <div class="offcanvas-body d-flex flex-column">
    <div class="flex-grow-1">
      <p class="text-muted small">
        Mockr is a simple tool for creating mock API endpoints and responses.
        Search and browse all available endpoints, or use the Manage panel to create new ones.
      </p>
      
      <% if ENV.fetch("GITHUB_ORGANIZATION", nil).present? %>
        <div class="alert alert-info-subtle d-flex align-items-start" role="alert">
          <i class="bi bi-info-circle me-2 mt-1"></i>
          <div>
            <strong>Organization Restriction</strong><br>
            <small>Only members of <code><%= ENV.fetch("GITHUB_ORGANIZATION") %></code> can access this application.</small>
          </div>
        </div>
      <% end %>
      
      <div class="card mt-3">
        <div class="card-header py-2">
          <small><i class="bi bi-key me-1"></i> API Token</small>
        </div>
        <div class="card-body py-2">
          <p class="text-muted small mb-2">
            Use this token in the <code>Authorization</code> header.
          </p>
          <%= render "user/regenerate_token" %>
        </div>
      </div>
    </div>
    
    <div class="offcanvas-footer pt-3 mt-3 border-top d-flex justify-content-center">
      <a
        href="https://github.com/ricardobucho/mockr"
        target="_blank"
        class="btn btn-header-action"
        data-bs-toggle="tooltip"
        data-bs-title="View on GitHub"
        data-bs-placement="top"
      >
        <i class="bi bi-github"></i>
      </a>
    </div>
  </div>
</div>
